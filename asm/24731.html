<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Skool Daze: Routine at 24731</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../sd.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="24699.html">24699</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24731">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="24825.html">24825</a></span></td>
</tr>
</table>
<div class="description">24731: Scroll the screen left one column</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="25820.html">25820</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24731"></a>24731</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24732"></a>24732</td>
<td class="instruction">LD HL,22529</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the leftmost end of the top row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24735"></a>24735</td>
<td class="instruction">LD DE,22528</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24738"></a>24738</td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 attribute bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24741"></a>24741</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24742"></a>24742</td>
<td class="instruction">LD HL,16385</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of pixels on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24745"></a>24745</td>
<td class="instruction">LD DE,16384</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24748"></a>24748</td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 display file bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24751"></a>24751</td>
<td class="instruction">LD A,21</td>
<td class="comment-11" rowspan="1">There are 21 rows of character squares to scroll</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24753"></a>24753</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24754"></a>24754</td>
<td class="instruction">LD A,8</td>
<td class="comment-11" rowspan="1">Each row of character squares contains 8 rows of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24756"></a>24756</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24757"></a>24757</td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24758"></a>24758</td>
<td class="instruction">LDIR</td>
<td class="comment-11" rowspan="1">Scroll a row of pixels left one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24760"></a>24760</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24761"></a>24761</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24762"></a>24762</td>
<td class="instruction">INC D</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the next row of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24763"></a>24763</td>
<td class="instruction">INC H</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24764"></a>24764</td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24766"></a>24766</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row in this block of 8x32</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24767"></a>24767</td>
<td class="instruction">JR NZ,24756</td>
<td class="comment-11" rowspan="1">Jump back until this 8x32 pixel block has been scrolled</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24769"></a>24769</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24770"></a>24770</td>
<td class="instruction">LDIR</td>
<td class="comment-11" rowspan="1">Scroll a row of attribute bytes left one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24772"></a>24772</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the leftmost end of the next row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24773"></a>24773</td>
<td class="instruction">INC DE</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24774"></a>24774</td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC'</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24776"></a>24776</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24777"></a>24777</td>
<td class="instruction">LD A,32</td>
<td class="comment-11" rowspan="6">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24779"></a>24779</td>
<td class="instruction">ADD A,E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24780"></a>24780</td>
<td class="instruction">LD E,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24781"></a>24781</td>
<td class="instruction">LD A,32</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24783"></a>24783</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24784"></a>24784</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24785"></a>24785</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24786"></a>24786</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row of character squares</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24787"></a>24787</td>
<td class="instruction">JR Z,24805</td>
<td class="comment-11" rowspan="1">Exit this loop if all 21 rows have been scrolled left</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24789"></a>24789</td>
<td class="instruction">CP 5</td>
<td class="comment-11" rowspan="1">Have we reached the bottom third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24791"></a>24791</td>
<td class="instruction">JR Z,24753</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24793"></a>24793</td>
<td class="instruction">CP 13</td>
<td class="comment-11" rowspan="1">Have we reached the middle third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24795"></a>24795</td>
<td class="instruction">JR Z,24753</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24797"></a>24797</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24798"></a>24798</td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="4">Point <span class="register">HL</span> and <span class="register">DE</span> at the leftmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24799"></a>24799</td>
<td class="instruction">SUB 8</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24801"></a>24801</td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24802"></a>24802</td>
<td class="instruction">LD D,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24803"></a>24803</td>
<td class="instruction">JR 24754</td>
<td class="comment-11" rowspan="1">Jump back to deal with the next row of character squares</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24805"></a>
<div class="comments">
<div class="paragraph">
The 21 rows of character squares have been scrolled one place to the left. Now the rightmost column needs to be filled.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24805"></a>24805</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24806"></a>24806</td>
<td class="instruction">LD HL,22559</td>
<td class="comment-11" rowspan="3">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the attribute file and display file addresses for the top right of the screen, and set <span class="register">BC'</span>=32; however, these values are not used</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24809"></a>24809</td>
<td class="instruction">LD DE,16415</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24812"></a>24812</td>
<td class="instruction">INC C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24813"></a>24813</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24814"></a>24814</td>
<td class="instruction">LD A,(32512)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the skool on-screen (0-64)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24817"></a>24817</td>
<td class="instruction">INC A</td>
<td class="comment-11" rowspan="2">We are scrolling one column left</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24818"></a>24818</td>
<td class="instruction">LD (32512),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24821"></a>24821</td>
<td class="instruction">ADD A,C</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=rightmost column of the skool on-screen (31-95)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24822"></a>24822</td>
<td class="instruction">JP <a class="link" href="24576.html#24670">24670</a></td>
<td class="comment-11" rowspan="1">Fill in the rightmost column</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="24699.html">24699</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24731">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="24825.html">24825</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Skool Daze RAM disassembly 20140614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd (Skool Daze). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>