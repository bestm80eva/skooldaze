<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Skool Daze: Routine at 24576</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../sd.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="Skool Daze" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="23296.html">23296</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24576">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="24699.html">24699</a></span></td>
</tr>
</table>
<div class="description">24576: Scroll the screen right one column</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="25810.html">25810</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24576"></a>24576</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24577"></a>24577</td>
<td class="instruction">LD HL,22558</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the rightmost end of the top row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24580"></a>24580</td>
<td class="instruction">LD DE,22559</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24583"></a>24583</td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 attribute bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24586"></a>24586</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24587"></a>24587</td>
<td class="instruction">LD HL,16414</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of pixels on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24590"></a>24590</td>
<td class="instruction">LD DE,16415</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24593"></a>24593</td>
<td class="instruction">LD BC,31</td>
<td class="comment-11" rowspan="1">We need to scroll 31 display file bytes at a time</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24596"></a>24596</td>
<td class="instruction">LD A,21</td>
<td class="comment-11" rowspan="1">There are 21 rows of character squares to scroll</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24598"></a>24598</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24599"></a>24599</td>
<td class="instruction">LD A,8</td>
<td class="comment-11" rowspan="1">Each row of character squares contains 8 rows of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24601"></a>24601</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24602"></a>24602</td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24603"></a>24603</td>
<td class="instruction">LDDR</td>
<td class="comment-11" rowspan="1">Scroll a row of pixels right one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24605"></a>24605</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24606"></a>24606</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24607"></a>24607</td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24609"></a>24609</td>
<td class="instruction">INC H</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL</span> and <span class="register">DE</span> at the next row of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24610"></a>24610</td>
<td class="instruction">INC D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24611"></a>24611</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row in this block of 8x32</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24612"></a>24612</td>
<td class="instruction">JR NZ,24601</td>
<td class="comment-11" rowspan="1">Jump back until this 8x32 pixel block has been scrolled</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24614"></a>24614</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24615"></a>24615</td>
<td class="instruction">LDDR</td>
<td class="comment-11" rowspan="1">Scroll a row of attribute bytes right one column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24617"></a>24617</td>
<td class="instruction">LD C,63</td>
<td class="comment-11" rowspan="5">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the rightmost end of the next row of attribute bytes on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24619"></a>24619</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24620"></a>24620</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24621"></a>24621</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24622"></a>24622</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24623"></a>24623</td>
<td class="instruction">LD C,31</td>
<td class="comment-11" rowspan="1"><span class="register">BC'</span>=31</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24625"></a>24625</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24626"></a>24626</td>
<td class="instruction">LD A,32</td>
<td class="comment-11" rowspan="6">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24628"></a>24628</td>
<td class="instruction">ADD A,E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24629"></a>24629</td>
<td class="instruction">LD E,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24630"></a>24630</td>
<td class="instruction">LD A,32</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24632"></a>24632</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24633"></a>24633</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24634"></a>24634</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24635"></a>24635</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Next row of character squares</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24636"></a>24636</td>
<td class="instruction">JR Z,24654</td>
<td class="comment-11" rowspan="1">Exit this loop if all 21 rows have been scrolled right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24638"></a>24638</td>
<td class="instruction">CP 13</td>
<td class="comment-11" rowspan="1">Have we reached the middle third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24640"></a>24640</td>
<td class="instruction">JR Z,24598</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24642"></a>24642</td>
<td class="instruction">CP 5</td>
<td class="comment-11" rowspan="1">Have we reached the bottom third of the screen?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24644"></a>24644</td>
<td class="instruction">JR Z,24598</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24646"></a>24646</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24647"></a>24647</td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="4">Point <span class="register">HL</span> and <span class="register">DE</span> at the rightmost end of the top row of the next 8x32 block of pixels</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24648"></a>24648</td>
<td class="instruction">SUB 8</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24650"></a>24650</td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24651"></a>24651</td>
<td class="instruction">LD D,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24652"></a>24652</td>
<td class="instruction">JR 24599</td>
<td class="comment-11" rowspan="1">Jump back to deal with the next row of character squares</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24654"></a>
<div class="comments">
<div class="paragraph">
The 21 rows of character squares have been scrolled one place to the right. Now the leftmost column needs to be filled.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24654"></a>24654</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24655"></a>24655</td>
<td class="instruction">LD HL,22528</td>
<td class="comment-11" rowspan="3">Point <span class="register">HL'</span> and <span class="register">DE'</span> at the attribute file and display file addresses for the top left of the screen, and set <span class="register">BC'</span>=32; however, these values are not used</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24658"></a>24658</td>
<td class="instruction">LD DE,16384</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24661"></a>24661</td>
<td class="instruction">INC C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24662"></a>24662</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24663"></a>24663</td>
<td class="instruction">LD A,(32512)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the skool on-screen (0-64)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24666"></a>24666</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="2">We are scrolling one column right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24667"></a>24667</td>
<td class="instruction">LD (32512),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24670"></a>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a class="link" href="24731.html">24731</a> with <span class="register">A</span> holding the x-coordinate of the rightmost column of the skool on-screen (31-95).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24670"></a>24670</td>
<td class="instruction">LD E,A</td>
<td class="comment-11" rowspan="1"><span class="register">E</span>=X (x-coordinate of the far left or far right column of the skool currently on-screen)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24671"></a>24671</td>
<td class="instruction">LD D,152</td>
<td class="comment-11" rowspan="1"><span class="register">D</span>=Y (152=y-coordinate of the top row of the screen)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24673"></a>24673</td>
<td class="instruction">LD B,21</td>
<td class="comment-11" rowspan="1">There are 21 rows (152&lt;=Y&lt;=172) on the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24675"></a>24675</td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24676"></a>24676</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24677"></a>24677</td>
<td class="instruction">CALL <a class="link" href="24843.html">24843</a></td>
<td class="comment-11" rowspan="1">Print the character square at (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24680"></a>24680</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24681"></a>24681</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24682"></a>24682</td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="6">Point <span class="register">HL</span> at the attribute file address corresponding to the skool coordinates (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24683"></a>24683</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24684"></a>24684</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24685"></a>24685</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24686"></a>24686</td>
<td class="instruction">ADD A,79</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24688"></a>24688</td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24689"></a>24689</td>
<td class="instruction">SET 7,E</td>
<td class="comment-11" rowspan="1">Point <span class="register">DE</span> at the attribute byte for the skool coordinates (X,Y)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24691"></a>24691</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-11" rowspan="1">Pick the attribute byte up in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24692"></a>24692</td>
<td class="instruction">RES 7,E</td>
<td class="comment-11" rowspan="1">Restore the skool coordinates (X,Y) to <span class="register">DE</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24694"></a>24694</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">Poke the attribute byte onto the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24695"></a>24695</td>
<td class="instruction">INC D</td>
<td class="comment-11" rowspan="1">Next row (Y) of the screen</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24696"></a>24696</td>
<td class="instruction">DJNZ 24675</td>
<td class="comment-11" rowspan="1">Jump back until all 21 rows are done</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24698"></a>24698</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="23296.html">23296</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24576">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="24699.html">24699</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Skool Daze RAM disassembly 20150413</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd (Skool Daze). &#169; 2015 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.3.</div>
</div>
</body>
</html>