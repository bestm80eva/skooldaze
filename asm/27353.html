<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Skool Daze: Routine at 27353</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../sd.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="27351.html">27351</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#27353">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="27387.html">27387</a></span></td>
</tr>
</table>
<div class="description">27353: Deal with  ERIC</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Called from the main loop at <a class="link" href="26471.html">26471</a>. Deals with ERIC when any of bits 0-4 at <a class="link" href="32763.html">32763</a> (ERIC's status flags) are set. Returns with the carry flag set if and only if ERIC was dealt with, indicating that there is no need to check keypresses in the main loop.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="27353"></a>27353</td>
<td class="instruction">CALL <a class="link" href="30636.html">30636</a></td>
<td class="comment-11" rowspan="1">Make any nearby teachers give ERIC lines if he's not where he should be, or standing or sitting when or where he shouldn't be</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27356"></a>27356</td>
<td class="instruction">LD A,(32763)</td>
<td class="comment-11" rowspan="3">Check ERIC's status flags at <a class="link" href="32763.html">32763</a> and return with the carry flag reset unless ERIC has been knocked over, or he is firing, hitting, jumping, or being spoken to</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27359"></a>27359</td>
<td class="instruction">AND 31</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27361"></a>27361</td>
<td class="instruction">RET Z</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27362"></a>27362</td>
<td class="instruction">LD HL,27351</td>
<td class="comment-11" rowspan="2">After dealing with ERIC, return to the main loop via the routine at <a class="link" href="27351.html">27351</a> with the carry flag set to indicate that ERIC was dealt with</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27365"></a>27365</td>
<td class="instruction">PUSH HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27366"></a>27366</td>
<td class="instruction">BIT 3,A</td>
<td class="comment-11" rowspan="1">Is ERIC being spoken to by a little boy?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27368"></a>27368</td>
<td class="instruction">JP NZ,<a class="link" href="63352.html">63352</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27371"></a>27371</td>
<td class="instruction">CP 16</td>
<td class="comment-11" rowspan="1">Has ERIC been knocked over?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27373"></a>27373</td>
<td class="instruction">JP NC,<a class="link" href="27303.html">27303</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27376"></a>27376</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Is ERIC firing a catapult?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27377"></a>27377</td>
<td class="instruction">JP Z,<a class="link" href="62495.html">62495</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27380"></a>27380</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Is ERIC hitting?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27381"></a>27381</td>
<td class="instruction">JP Z,<a class="link" href="62628.html">62628</a></td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="27384"></a>27384</td>
<td class="instruction">JP <a class="link" href="62771.html">62771</a></td>
<td class="comment-11" rowspan="1">ERIC is jumping; deal with him accordingly</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="27351.html">27351</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#27353">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="27387.html">27387</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Skool Daze RAM disassembly 20140614</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd (Skool Daze). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>