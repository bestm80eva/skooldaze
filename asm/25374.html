<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Skool Daze: Routine at 25374</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../sd.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="Skool Daze" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="25373.html">25373</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#25374">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="25402.html">25402</a></span></td>
</tr>
</table>
<div class="description">25374: Check whether a signal has been raised</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routines at <a class="link" href="25303.html">25303</a> and <a class="link" href="32167.html">32167</a>. On entry, <span class="register">A</span> holds the event identifier, which will be one of:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">A</th>
<th colspan="1" rowspan="1">Description</th>
<th colspan="1" rowspan="1">Flags</th>
<th colspan="1" rowspan="1">Bit</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">0</td>
<td class="" colspan="1" rowspan="1">End of lesson/playtime</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32712.html">32712</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">8</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Map Room</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32713.html">32713</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">9</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Reading Room</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32713.html">32713</a></td>
<td class="centre" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">10</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the Exam Room</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32713.html">32713</a></td>
<td class="centre" colspan="1" rowspan="1">2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">11</td>
<td class="" colspan="1" rowspan="1">Teacher has arrived at the White Room</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32713.html">32713</a></td>
<td class="centre" colspan="1" rowspan="1">3</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">16</td>
<td class="" colspan="1" rowspan="1">Little boy no. 1 is ready to stampede</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32714.html">32714</a></td>
<td class="centre" colspan="1" rowspan="1">0</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">17</td>
<td class="" colspan="1" rowspan="1">Little boy no. 1 is ready to stampede again</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32714.html">32714</a></td>
<td class="centre" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">26</td>
<td class="" colspan="1" rowspan="1">EINSTEIN or BOY WANDER is ready</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32715.html">32715</a></td>
<td class="centre" colspan="1" rowspan="1">2</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">27</td>
<td class="" colspan="1" rowspan="1">MR WACKER is ready</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32715.html">32715</a></td>
<td class="centre" colspan="1" rowspan="1">3</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">28</td>
<td class="" colspan="1" rowspan="1">ERIC has been told about EINSTEIN, BOY WANDER or ANGELFACE</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32715.html">32715</a></td>
<td class="centre" colspan="1" rowspan="1">4</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1">29</td>
<td class="" colspan="1" rowspan="1">EINSTEIN has told MR WACKER what ERIC's up to, or ERIC has mumps</td>
<td class="" colspan="1" rowspan="1"><a class="link" href="32715.html">32715</a></td>
<td class="centre" colspan="1" rowspan="1">5</td>
</tr>
</table>
</div>
<div class="paragraph">
The routine returns with the zero flag reset if the corresponding signal has been raised.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">Event ID from a command list</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="25374"></a>25374</td>
<td class="instruction">PUSH AF</td>
<td class="comment-11" rowspan="1">Save the event identifier briefly</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25375"></a>25375</td>
<td class="instruction">AND 248</td>
<td class="comment-11" rowspan="4">Keep only bits 3-7 (the byte index) and shift them into bits 0-4</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25377"></a>25377</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25378"></a>25378</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25379"></a>25379</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25380"></a>25380</td>
<td class="instruction">ADD A,200</td>
<td class="comment-11" rowspan="2">Modify the LD A,(m) instruction at <a class="link" href="25374.html#25396">25396</a> below so that m is <a class="link" href="32712.html">32712</a>, <a class="link" href="32713.html">32713</a>, <a class="link" href="32714.html">32714</a> or <a class="link" href="32715.html">32715</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25382"></a>25382</td>
<td class="instruction">LD (25397),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25385"></a>25385</td>
<td class="instruction">POP AF</td>
<td class="comment-11" rowspan="1">Restore the event identifier to <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25386"></a>25386</td>
<td class="instruction">AND 7</td>
<td class="comment-11" rowspan="1">Keep only bits 0-2 (the bit index)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25388"></a>25388</td>
<td class="instruction">ADD A,A</td>
<td class="comment-11" rowspan="5">Modify the BIT n,A instruction at <a class="link" href="25374.html#25399">25399</a> below so that n=<span class="register">A</span> (0-7)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25389"></a>25389</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25390"></a>25390</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25391"></a>25391</td>
<td class="instruction">ADD A,71</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25393"></a>25393</td>
<td class="instruction">LD (25400),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25396"></a>25396</td>
<td class="instruction">LD A,(32712)</td>
<td class="comment-11" rowspan="1">Pick up the byte holding the signal flag for this event (the operand of this instruction is modified earlier in this routine)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25399"></a>25399</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1">Reset the zero flag if the signal has been raised (this instruction is modified earlier in this routine to check the appropriate bit)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25401"></a>25401</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="25373.html">25373</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#25374">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="25402.html">25402</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Skool Daze RAM disassembly 20150413</div>
<div class="copyright">&#169; 1984 Microsphere Computer Services Ltd (Skool Daze). &#169; 2015 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.3.</div>
</div>
</body>
</html>